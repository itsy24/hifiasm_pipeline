params {
    config_profile_description = 'New York University HPC profile provided by nf-core/configs.'
    config_profile_contact     = 'HPC@nyu.edu'
    config_profile_url         = 'https://hpc.nyu.edu'
    max_memory                 = 3000.GB
    max_cpus                   = 96
    max_time                   = 7.d
}

singularity.enabled = true

process {
    resourceLimits = [
        memory: 3000.GB,
        cpus: 96,
        time: 7.d
    ]
    executor       = 'slurm'
    clusterOptions = '--export=NONE --account=pr_278_general'
    maxRetries     = 3
    errorStrategy  = { task.attempt <= 3 ? 'retry' : 'finish' }
    cache          = 'lenient'

    conda.enabled = true
    conda.cacheDir = "/scratch/igs2051/conda_env"

    withName: 'fastQC' {
      module = 'fastqc/0.11.9'
    }

    withName: 'fastplong' {
      //conda = 'bioconda::fastplong=0.2.2'
      container = 'docker://quay.io/biocontainers/fastplong:0.4.1--h224cc79_0'
    }

    withName: 'hifiasm' {
      module = 'hifiasm/0.20.0-r639'
      memory = '40GB'
      cpus = 32
    }

    withName: 'gfa_tools' {
      //conda = 'bioconda::gfatools=0.5.5'
      container = 'docker://quay.io/biocontainers/gfatools:0.5.5--h577a1d6_0'
    }

    withName: 'minimap2' {
      module = ['minimap2/2.22', 'samtools/1.22.1']
      //container = 'docker://quay.io/biocontainers/minimap2:2.28--he4a0461_2'
      cpus = 8
      memory = '48 GB'
    
    }

    withName: 'merqury' {
      //conda = 'bioconda::merqury=1.3'
      container = 'docker://quay.io/biocontainers/merqury:1.3--hdfd78af_3'
    }

    withName: 'busco' {
      //conda = 'bioconda::busco=6.0.0'
      container = 'docker://quay.io/biocontainers/busco:6.0.0--pyhdfd78af_1'
    }

    withName: quast {
      //conda = 'bioconda::quast=5.3.0'
      container = 'docker://quay.io/biocontainers/quast:5.3.0--py313pl5321h5ca1c30_2'
    }

    withName: multiqc {
      //conda = 'bioconda::multiqc=1.32'
      container = 'docker://quay.io/biocontainers/multiqc:1.32--pyhdfd78af_1'
    }



}

executor {
    queueSize       = 1900
    submitRateLimit = '20 sec'
}

